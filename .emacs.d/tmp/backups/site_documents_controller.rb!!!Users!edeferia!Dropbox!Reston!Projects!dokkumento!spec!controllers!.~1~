require 'spec_helper'


describe SiteDocumentsController do
 include ControllerMacros

 before :all do
   signup_user
 end

 def valid_attributes
   {
     :name => "Document template",
     :description => "Document template description",
     :file => fixture_file_upload("#{Rails.root}/spec/fixtures/files/testfile.pdf", 'application/pdf'),
     :document_type => DocumentType.first.id.to_s
     # Rack::Test::UploadedFile.new("#{Rails.root}/public/test.pdf", 'application/pdf')
   }
 end

 def valid_session
   {

   }
 end

 describe "POST create" do
   login_user

   it "creates a new Document Template" do

      expect {
       post :create, {:document_template => valid_attributes, :organization => @user.member.organization }
      }.to change(DocumentTemplate, :count).by(1)

   end

 end


 describe "GET index" do
   login_user

   it "retrives a list of Document Templates" do
     get :index
     expect(response).to render_template :index
   end
 end


end
