(ns finaicore.core
  (:require [clojure.core.matrix  :as cm]
            [clojure.core.matrix.operators :as cmo])
  (:use
        (enclog nnets training)))

(defn -activate-layer
  [inputs weights]
  "Computes the output of a layer of neurons given their inputs, weights and activation
   function."
  (mapv activation-fn
        (mapv #(reduce + %)
                     (cmo/* inputs (cm/transpose strengths)))))

(defn -output-deltas [targets outputs]
  "measures the delta errors for the output layer (Desired value â€“ actual value) and multiplying it by the gradient of the activation function"
  (cmo/* (mapv dactivation-fn outputs)
          (cmo/- targets outputs)))
